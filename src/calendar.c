#include "calendar.h"

#include <stdio.h>
#include <stdlib.h>
#include <string.h>

const int START_YEAR = 1901;
const int MONTH_DAY_BIT = 12;
const int MONTH_NUM_BIT = 13;
const int MILLISECOND_OF_YEAR = 86400000;

static const int MONTH_DAYS[12] = {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};

const char* HAN_NUMBER[] = {
    "零", "一", "二", "三", "四", "五", "六", "七", "八", "九", "十"
};
const char* HAN_YUEFEN[] = {
    "正月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "冬月", "腊月"
};
const char* HAN_RIQI[] = {
    "初一", "初二", "初三", "初四", "初五", "初六", "初七", "初八", "初九", "初十", "十一", "十二",
    "十三", "十四", "十五", "十六", "十七", "十八", "十九", "二十", "廿一", "廿二", "廿三", "廿四",
    "廿五", "廿六", "廿七", "廿八", "廿九", "三十"
};

const char* HAN_XINGQI[] = {"星期一", "星期二", "星期三", "星期四", "星期五", "星期六", "星期日"};

const char* HAN_TIANGAN[] = {"甲", "乙", "丙", "丁", "戊", "己", "庚", "辛", "壬", "癸"};
const char* HAN_DIZHI[] = {"子", "丑", "寅", "卯", "辰", "巳", "午", "未", "申", "酉", "戌", "亥"};
const char* HAN_SHENGXIAO[] = {"鼠", "牛", "虎", "兔", "龙", "蛇", "马", "羊", "猴", "鸡", "狗", "猪"};

// 节气在公历中每个月有两个，分别在上半月和下半月
// 上半月的叫“节气”，下半月的叫“中气”
const char* HAN_JIEQI[] = {
	"小寒", "大寒", // 1月
    "立春", "雨水", // 2月
    "惊蛰", "春分", // 3月
    "清明", "谷雨", // 4月
    "立夏", "小满", // 5月
    "芒种", "夏至", // 6月
    "小暑", "大暑", // 7月
    "立秋", "处暑", // 8月
    "白露", "秋分", // 9月
    "寒露", "霜降", // 10月
    "立冬", "小雪", // 11月
    "大雪", "冬至", // 12月
};

const char* HAN_DUAN[] = {"夜半", "鸡鸣", "平旦", "日出", "食时", "隅中", "日中", "日昳", "晡时", "日入", "黄昏", "人定"};
// 星座日期按照节气中的中气划分
// 摩羯座日期为：上一年12月中气后~公历1月的中气前，
const char* HAN_XINGZUO[] = {"摩羯座", "水瓶座", "双鱼座", "白羊座", "金牛座", "双子座", "巨蟹座", "狮子座", "处女座", "天秤座", "天蝎座", "射手座"};
// 星纪：大雪~冬至，按照节气（干支月份）划分
const char* HAN_XINGCI[] = {"星纪", "玄枵", "娵訾", "降娄", "大梁", "实沈", "鹑首", "鹑火", "鹑尾", "寿星", "大火", "析木"};


/**
 * 农历每年有12（平年）~13（闰年）个月，每个月有29（小月）/30天（大月）
 * g_lunar_month_day存储1900-2100年中的每个月各有多少天
 * 对于每一个元素：
 *      12-0bit：每一个比特位表示一个月的天数，0表示小月，1表示大月；12bit表示闰月
 *      16-13bit：闰月月份（闰几月）
 *      19-17bit：补0
 */
static const unsigned int G_LUNAR_MONTH_DAY[] = {
	0x00752, 0x00ea5, 0x0ab2a, 0x0064b, 0x00a9b, 0x09aa6, 0x0056a, 0x00b59, 0x04baa, 0x00752, // 1901 ~ 1910 
	0x0cda5, 0x00b25, 0x00a4b, 0x0ba4b, 0x002ad, 0x0056b, 0x045b5, 0x00da9, 0x0fe92, 0x00e92, // 1911 ~ 1920 
	0x00d25, 0x0ad2d, 0x00a56, 0x002b6, 0x09ad5, 0x006d4, 0x00ea9, 0x04f4a, 0x00e92, 0x0c6a6, // 1921 ~ 1930 
	0x0052b, 0x00a57, 0x0b956, 0x00b5a, 0x006d4, 0x07761, 0x00749, 0x0fb13, 0x00a93, 0x0052b, // 1931 ~ 1940 
	0x0d51b, 0x00aad, 0x0056a, 0x09da5, 0x00ba4, 0x00b49, 0x04d4b, 0x00a95, 0x0eaad, 0x00536, // 1941 ~ 1950 
	0x00aad, 0x0baca, 0x005b2, 0x00da5, 0x07ea2, 0x00d4a, 0x10595, 0x00a97, 0x00556, 0x0c575, // 1951 ~ 1960 
	0x00ad5, 0x006d2, 0x08755, 0x00ea5, 0x0064a, 0x0664f, 0x00a9b, 0x0eada, 0x0056a, 0x00b69, // 1961 ~ 1970 
	0x0abb2, 0x00b52, 0x00b25, 0x08b2b, 0x00a4b, 0x10aab, 0x002ad, 0x0056d, 0x0d5a9, 0x00da9, // 1971 ~ 1980 
	0x00d92, 0x08e95, 0x00d25, 0x14e4d, 0x00a56, 0x002b6, 0x0c2f5, 0x006d5, 0x00ea9, 0x0af52, // 1981 ~ 1990 
	0x00e92, 0x00d26, 0x0652e, 0x00a57, 0x10ad6, 0x0035a, 0x006d5, 0x0ab69, 0x00749, 0x00693, // 1991 ~ 2000 
	0x08a9b, 0x0052b, 0x00a5b, 0x04aae, 0x0056a, 0x0edd5, 0x00ba4, 0x00b49, 0x0ad53, 0x00a95, // 2001 ~ 2010 
	0x0052d, 0x0855d, 0x00ab5, 0x12baa, 0x005d2, 0x00da5, 0x0de8a, 0x00d4a, 0x00c95, 0x08a9e, // 2011 ~ 2020 
	0x00556, 0x00ab5, 0x04ada, 0x006d2, 0x0c765, 0x00725, 0x0064b, 0x0a657, 0x00cab, 0x0055a, // 2021 ~ 2030 
	0x0656e, 0x00b69, 0x16f52, 0x00b52, 0x00b25, 0x0dd0b, 0x00a4b, 0x004ab, 0x0a2bb, 0x005ad, // 2031 ~ 2040 
	0x00b6a, 0x04daa, 0x00d92, 0x0eea5, 0x00d25, 0x00a55, 0x0ba4d, 0x004b6, 0x005b5, 0x076d2, // 2041 ~ 2050 
	0x00ec9, 0x10f92, 0x00e92, 0x00d26, 0x0d516, 0x00a57, 0x00556, 0x09365, 0x00755, 0x00749, // 2051 ~ 2060 
	0x0674b, 0x00693, 0x0eaab, 0x0052b, 0x00a5b, 0x0aaba, 0x0056a, 0x00b65, 0x08baa, 0x00b4a, // 2061 ~ 2070 
	0x10d95, 0x00a95, 0x0052d, 0x0c56d, 0x00ab5, 0x005aa, 0x085d5, 0x00da5, 0x00d4a, 0x06e4d, // 2071 ~ 2080 
	0x00c96, 0x0ecce, 0x00556, 0x00ab5, 0x0bad2, 0x006d2, 0x00ea5, 0x0872a, 0x0068b, 0x10697, // 2081 ~ 2090 
	0x004ab, 0x0055b, 0x0d556, 0x00b6a, 0x00752, 0x08b95, 0x00b45, 0x00a8b, 0x04a4f
};

/**
 * 对于每一个元素：
 *      12-7bit：春节距离元旦多少天
 *      6-5bit：春节公历月（春节在公历1月21日到2月21日直接）
 *      4-0bit：春节公历日
 */
static const unsigned short G_LUNAR_YEAR_DAY[] = {
	0x18d3, 0x1348, 0x0e3d, 0x1750, 0x1144, 0x0c39, 0x15cd, 0x1042, 0x0ab6, 0x144a, // 1901 ~ 1910 
	0x0ebe, 0x1852, 0x1246, 0x0cba, 0x164e, 0x10c3, 0x0b37, 0x14cb, 0x0fc1, 0x1954, // 1911 ~ 1920 
	0x1348, 0x0dbc, 0x1750, 0x11c5, 0x0bb8, 0x15cd, 0x1042, 0x0b37, 0x144a, 0x0ebe, // 1921 ~ 1930 
	0x17d1, 0x1246, 0x0cba, 0x164e, 0x1144, 0x0bb8, 0x14cb, 0x0f3f, 0x18d3, 0x1348, // 1931 ~ 1940 
	0x0d3b, 0x16cf, 0x11c5, 0x0c39, 0x15cd, 0x1042, 0x0ab6, 0x144a, 0x0e3d, 0x17d1, // 1941 ~ 1950 
	0x1246, 0x0d3b, 0x164e, 0x10c3, 0x0bb8, 0x154c, 0x0f3f, 0x1852, 0x1348, 0x0dbc, // 1951 ~ 1960 
	0x16cf, 0x11c5, 0x0c39, 0x15cd, 0x1042, 0x0a35, 0x13c9, 0x0ebe, 0x17d1, 0x1246, // 1961 ~ 1970 
	0x0d3b, 0x16cf, 0x10c3, 0x0b37, 0x14cb, 0x0f3f, 0x1852, 0x12c7, 0x0dbc, 0x1750, // 1971 ~ 1980 
	0x11c5, 0x0c39, 0x15cd, 0x1042, 0x1954, 0x13c9, 0x0e3d, 0x17d1, 0x1246, 0x0d3b, // 1981 ~ 1990 
	0x16cf, 0x1144, 0x0b37, 0x144a, 0x0f3f, 0x18d3, 0x12c7, 0x0dbc, 0x1750, 0x11c5, // 1991 ~ 2000 
	0x0bb8, 0x154c, 0x0fc1, 0x0ab6, 0x13c9, 0x0e3d, 0x1852, 0x12c7, 0x0cba, 0x164e, // 2001 ~ 2010 
	0x10c3, 0x0b37, 0x144a, 0x0f3f, 0x18d3, 0x1348, 0x0dbc, 0x1750, 0x11c5, 0x0c39, // 2011 ~ 2020 
	0x154c, 0x0fc1, 0x0ab6, 0x144a, 0x0e3d, 0x17d1, 0x1246, 0x0cba, 0x15cd, 0x10c3, // 2021 ~ 2030 
	0x0b37, 0x14cb, 0x0f3f, 0x18d3, 0x1348, 0x0dbc, 0x16cf, 0x1144, 0x0bb8, 0x154c, // 2031 ~ 2040 
	0x0fc1, 0x0ab6, 0x144a, 0x0ebe, 0x17d1, 0x1246, 0x0cba, 0x164e, 0x1042, 0x0b37, // 2041 ~ 2050 
	0x14cb, 0x0fc1, 0x18d3, 0x1348, 0x0dbc, 0x16cf, 0x1144, 0x0a38, 0x154c, 0x1042, // 2051 ~ 2060 
	0x0a35, 0x13c9, 0x0e3d, 0x17d1, 0x11c5, 0x0cba, 0x164e, 0x10c3, 0x0b37, 0x14cb, // 2061 ~ 2070 
	0x0f3f, 0x18d3, 0x12c7, 0x0d3b, 0x16cf, 0x11c5, 0x0bb8, 0x154c, 0x1042, 0x0ab6, // 2071 ~ 2080 
	0x13c9, 0x0e3d, 0x17d1, 0x1246, 0x0cba, 0x164e, 0x10c3, 0x0bb8, 0x144a, 0x0ebe, // 2081 ~ 2090 
	0x1852, 0x12c7, 0x0d3b, 0x16cf, 0x11c5, 0x0c39, 0x154c, 0x0fc1, 0x0a35, 0x13c9, // 2091 ~ 2100 
};


/*******************************************************
数组gLanarHoliDay存放每年的二十四节气对应的阳历日期 
每年的二十四节气对应的阳历日期几乎固定，平均分布于十二个月中 
1月 2月 3月 4月 5月 6月 
小寒 大寒 立春 雨水 惊蛰 春分 清明 谷雨 立夏 小满 芒种 夏至 
7月 8月 9月 10月 11月 12月 
小暑 大暑 立秋 处暑 白露 秋分 寒露 霜降 立冬 小雪 大雪 冬至 
数据格式说明: 
如1901年的节气为 
1月 2月 3月 4月 5月 6月 7月 8月 9月 10月 11月 12月 
6, 21, 4, 19, 6, 21, 5, 21, 6,22, 6,22, 8, 23, 8, 24, 8, 24, 8, 24, 8, 23, 8, 22 
9, 6, 11,4, 9, 6, 10,6, 9,7, 9,7, 7, 8, 7, 9, 7, 9, 7, 9, 7, 8, 7, 15 
上面第一行数据为每月节气对应日期,15减去每月第一个节气,每月第二个节气减去15得第二行 
这样每月两个节气对应数据都小于16,每月用一个字节存放,高位存放第一个节气数据,低位存放 
第二个节气的数据,可得下表 
*******************************************************/
const unsigned char G_LUNAR_JIEQI[] = {
    0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1901 
    0x96, 0xA4, 0x96, 0x96, 0x97, 0x87, 0x79, 0x79, 0x79, 0x69, 0x78, 0x78, //1902 
    0x96, 0xA5, 0x87, 0x96, 0x87, 0x87, 0x79, 0x69, 0x69, 0x69, 0x78, 0x78, //1903 
    0x86, 0xA5, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x78, 0x87, //1904 
    0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1905 
    0x96, 0xA4, 0x96, 0x96, 0x97, 0x97, 0x79, 0x79, 0x79, 0x69, 0x78, 0x78, //1906 
    0x96, 0xA5, 0x87, 0x96, 0x87, 0x87, 0x79, 0x69, 0x69, 0x69, 0x78, 0x78, //1907 
    0x86, 0xA5, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1908 
    0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1909 
    0x96, 0xA4, 0x96, 0x96, 0x97, 0x97, 0x79, 0x79, 0x79, 0x69, 0x78, 0x78, //1910 
    0x96, 0xA5, 0x87, 0x96, 0x87, 0x87, 0x79, 0x69, 0x69, 0x69, 0x78, 0x78, //1911 
    0x86, 0xA5, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1912 
    0x95, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1913 
    0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x79, 0x79, 0x79, 0x69, 0x78, 0x78, //1914 
    0x96, 0xA5, 0x97, 0x96, 0x97, 0x87, 0x79, 0x79, 0x69, 0x69, 0x78, 0x78, //1915 
    0x96, 0xA5, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //1916 
    0x95, 0xB4, 0x96, 0xA6, 0x96, 0x97, 0x78, 0x79, 0x78, 0x69, 0x78, 0x87, //1917 
    0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x79, 0x79, 0x79, 0x69, 0x78, 0x77, //1918 
    0x96, 0xA5, 0x97, 0x96, 0x97, 0x87, 0x79, 0x79, 0x69, 0x69, 0x78, 0x78, //1919 
    0x96, 0xA5, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //1920 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x78, 0x79, 0x78, 0x69, 0x78, 0x87, //1921 
    0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x79, 0x79, 0x79, 0x69, 0x78, 0x77, //1922 
    0x96, 0xA4, 0x96, 0x96, 0x97, 0x87, 0x79, 0x79, 0x69, 0x69, 0x78, 0x78, //1923 
    0x96, 0xA5, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //1924 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x78, 0x79, 0x78, 0x69, 0x78, 0x87, //1925 
    0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1926 
    0x96, 0xA4, 0x96, 0x96, 0x97, 0x87, 0x79, 0x79, 0x79, 0x69, 0x78, 0x78, //1927 
    0x96, 0xA5, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //1928 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //1929 
    0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1930 
    0x96, 0xA4, 0x96, 0x96, 0x97, 0x87, 0x79, 0x79, 0x79, 0x69, 0x78, 0x78, //1931 
    0x96, 0xA5, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //1932 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1933 
    0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1934 
    0x96, 0xA4, 0x96, 0x96, 0x97, 0x97, 0x79, 0x79, 0x79, 0x69, 0x78, 0x78, //1935 
    0x96, 0xA5, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //1936 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1937 
    0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1938 
    0x96, 0xA4, 0x96, 0x96, 0x97, 0x97, 0x79, 0x79, 0x79, 0x69, 0x78, 0x78, //1939 
    0x96, 0xA5, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //1940 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1941 
    0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1942 
    0x96, 0xA4, 0x96, 0x96, 0x97, 0x97, 0x79, 0x79, 0x79, 0x69, 0x78, 0x78, //1943 
    0x96, 0xA5, 0x96, 0xA5, 0xA6, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //1944 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //1945 
    0x95, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x78, 0x69, 0x78, 0x77, //1946 
    0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x79, 0x79, 0x79, 0x69, 0x78, 0x78, //1947 
    0x96, 0xA5, 0xA6, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //1948 
    0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x79, 0x78, 0x79, 0x77, 0x87, //1949 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x78, 0x79, 0x78, 0x69, 0x78, 0x77, //1950 
    0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x79, 0x79, 0x79, 0x69, 0x78, 0x78, //1951 
    0x96, 0xA5, 0xA6, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //1952 
    0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //1953 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x78, 0x79, 0x78, 0x68, 0x78, 0x87, //1954 
    0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1955 
    0x96, 0xA5, 0xA5, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //1956 
    0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //1957 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1958 
    0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1959 
    0x96, 0xA4, 0xA5, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //1960 
    0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //1961 
    0x96, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1962 
    0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1963 
    0x96, 0xA4, 0xA5, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //1964 
    0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //1965 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1966 
    0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1967 
    0x96, 0xA4, 0xA5, 0xA5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //1968 
    0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //1969 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1970 
    0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1971 
    0x96, 0xA4, 0xA5, 0xA5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //1972 
    0xA5, 0xB5, 0x96, 0xA5, 0xA6, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //1973 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1974 
    0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x78, 0x69, 0x78, 0x77, //1975 
    0x96, 0xA4, 0xA5, 0xB5, 0xA6, 0xA6, 0x88, 0x89, 0x88, 0x78, 0x87, 0x87, //1976 
    0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //1977 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x78, 0x87, //1978 
    0x96, 0xB4, 0x96, 0xA6, 0x96, 0x97, 0x78, 0x79, 0x78, 0x69, 0x78, 0x77, //1979 
    0x96, 0xA4, 0xA5, 0xB5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //1980 
    0xA5, 0xB4, 0x96, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x77, 0x87, //1981 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //1982 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x78, 0x79, 0x78, 0x69, 0x78, 0x77, //1983 
    0x96, 0xB4, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x87, //1984 
    0xA5, 0xB4, 0xA6, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //1985 
    0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //1986 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x79, 0x78, 0x69, 0x78, 0x87, //1987 
    0x96, 0xB4, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x86, //1988 
    0xA5, 0xB4, 0xA5, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //1989 
    0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //1990 
    0x95, 0xB4, 0x96, 0xA5, 0x86, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1991 
    0x96, 0xB4, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x86, //1992 
    0xA5, 0xB3, 0xA5, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //1993 
    0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //1994 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x76, 0x78, 0x69, 0x78, 0x87, //1995 
    0x96, 0xB4, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x86, //1996 
    0xA5, 0xB3, 0xA5, 0xA5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //1997 
    0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //1998 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1999 
    0x96, 0xB4, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x86, //2000 
    0xA5, 0xB3, 0xA5, 0xA5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //2001 
    0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //2002 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //2003 
    0x96, 0xB4, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x86, //2004 
    0xA5, 0xB3, 0xA5, 0xA5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //2005 
    0xA5, 0xB4, 0x96, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //2006 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //2007 
    0x96, 0xB4, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x87, 0x78, 0x87, 0x86, //2008 
    0xA5, 0xB3, 0xA5, 0xB5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //2009 
    0xA5, 0xB4, 0x96, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //2010 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x78, 0x87, //2011 
    0x96, 0xB4, 0xA5, 0xB5, 0xA5, 0xA6, 0x87, 0x88, 0x87, 0x78, 0x87, 0x86, //2012 
    0xA5, 0xB3, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x87, //2013 
    0xA5, 0xB4, 0x96, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //2014 
    0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //2015 
    0x95, 0xB4, 0xA5, 0xB4, 0xA5, 0xA6, 0x87, 0x88, 0x87, 0x78, 0x87, 0x86, //2016 
    0xA5, 0xC3, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x87, //2017 
    0xA5, 0xB4, 0xA6, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //2018 
    0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //2019 
    0x95, 0xB4, 0xA5, 0xB4, 0xA5, 0xA6, 0x97, 0x87, 0x87, 0x78, 0x87, 0x86, //2020 
    0xA5, 0xC3, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x86, //2021 
    0xA5, 0xB4, 0xA5, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //2022 
    0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //2023 
    0x95, 0xB4, 0xA5, 0xB4, 0xA5, 0xA6, 0x97, 0x87, 0x87, 0x78, 0x87, 0x96, //2024 
    0xA5, 0xC3, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x86, //2025 
    0xA5, 0xB3, 0xA5, 0xA5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //2026 
    0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //2027 
    0x95, 0xB4, 0xA5, 0xB4, 0xA5, 0xA6, 0x97, 0x87, 0x87, 0x78, 0x87, 0x96, //2028 
    0xA5, 0xC3, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x86, //2029 
    0xA5, 0xB3, 0xA5, 0xA5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //2030 
    0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //2031 
    0x95, 0xB4, 0xA5, 0xB4, 0xA5, 0xA6, 0x97, 0x87, 0x87, 0x78, 0x87, 0x96, //2032 
    0xA5, 0xC3, 0xA5, 0xB5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x86, //2033 
    0xA5, 0xB3, 0xA5, 0xA5, 0xA6, 0xA6, 0x88, 0x78, 0x88, 0x78, 0x87, 0x87, //2034 
    0xA5, 0xB4, 0x96, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //2035 
    0x95, 0xB4, 0xA5, 0xB4, 0xA5, 0xA6, 0x97, 0x87, 0x87, 0x78, 0x87, 0x96, //2036 
    0xA5, 0xC3, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x86, //2037 
    0xA5, 0xB3, 0xA5, 0xA5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //2038 
    0xA5, 0xB4, 0x96, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //2039 
    0x95, 0xB4, 0xA5, 0xB4, 0xA5, 0xA6, 0x97, 0x87, 0x87, 0x78, 0x87, 0x96, //2040 
    0xA5, 0xC3, 0xA5, 0xB5, 0xA5, 0xA6, 0x87, 0x88, 0x87, 0x78, 0x87, 0x86, //2041 
    0xA5, 0xB3, 0xA5, 0xB5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //2042 
    0xA5, 0xB4, 0x96, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //2043 
    0x95, 0xB4, 0xA5, 0xB4, 0xA5, 0xA6, 0x97, 0x87, 0x87, 0x88, 0x87, 0x96, //2044 
    0xA5, 0xC3, 0xA5, 0xB4, 0xA5, 0xA6, 0x87, 0x88, 0x87, 0x78, 0x87, 0x86, //2045 
    0xA5, 0xB3, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x87, //2046 
    0xA5, 0xB4, 0x96, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //2047 
    0x95, 0xB4, 0xA5, 0xB4, 0xA5, 0xA5, 0x97, 0x87, 0x87, 0x88, 0x86, 0x96, //2048 
    0xA4, 0xC3, 0xA5, 0xA5, 0xA5, 0xA6, 0x97, 0x87, 0x87, 0x78, 0x87, 0x86, //2049 
    0xA5, 0xC3, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x78, 0x78, 0x87, 0x87
};

// 获取指定年月日的时间戳
unsigned long long get_timestamp(const int year, const int month, const int day)
{
    unsigned long long days = 0;
    for (int i = 1970; i < year; ++i) {
        if (is_solar_leap_year(i)) {
            days += 366;
        }
        else {
            days += 365;
        }
    }
    for (int i = 0; i < month - 1; ++i) {
        days += MONTH_DAYS[i];
    }
    if (month > 2 && is_solar_leap_year(year)) {
        days += 1;
    }
    days += day - 1;
    // int * int -> int，结果会溢出
    return days * MILLISECOND_OF_YEAR;
}

// 公历闰年返回TRUE，否则返回FALSE
BOOL is_solar_leap_year(const int year)
{
    return ((year % 4 == 0) && (year % 100 != 0) || (year % 400 == 0));
}

// 获取(leap_month, leap_month_day)
BOOL get_leap_month_info(const int lunar_year, LeapMonthInfo *leapMonthInfo)
{
    const unsigned int data = G_LUNAR_MONTH_DAY[lunar_year - START_YEAR];
    leapMonthInfo->lunar_month = (data >> MONTH_NUM_BIT) & 0xf;
    if (leapMonthInfo->lunar_month) {
        if (data & (1 << MONTH_DAY_BIT)) {
            leapMonthInfo->leap_month_days = 30;
        }
        else {
            leapMonthInfo->leap_month_days = 29;
        }
        return TRUE;
    }
    return FALSE;
}

// 返回指定农历年月的天数
int get_lunar_month_days(const int lunar_year, const int lunar_month)
{
    return (G_LUNAR_MONTH_DAY[lunar_year - START_YEAR] & (1 << (lunar_month - 1))) ? 30 : 29;
}

// 获取(lunar_year, lunar_month, lunar_day, is_leap)
BOOL get_lunar_date(const int year, const int month, const int day, LunarDate *lunarDate)
{
    int lunar_year = year, lunar_month = 1, lunar_day = 1;
    BOOL is_leap = FALSE;
    // 获取year年春节的公历信息
    const unsigned short data = G_LUNAR_YEAR_DAY[year - START_YEAR];
    const unsigned short chunjie_month = (data >> 5) & 0x3;
    const unsigned short chunjie_day = data & 0x1f;
    LeapMonthInfo leapMonthInfo;
    get_leap_month_info(lunar_year, &leapMonthInfo);

    int span_days = (get_timestamp(year, month, day) - get_timestamp(year, chunjie_month, chunjie_day)) / MILLISECOND_OF_YEAR;
    if (span_days >= 0) {
        int month_days = get_lunar_month_days(lunar_year, lunar_month);
        while (span_days >= month_days) {
            span_days -= month_days;
            // 闰月
            if (lunar_month == leapMonthInfo.lunar_month) {
                if (span_days < leapMonthInfo.leap_month_days) {
                    is_leap = TRUE;
                    break;
                }
                span_days -= leapMonthInfo.leap_month_days;
            }
            lunar_month += 1;
            month_days = get_lunar_month_days(lunar_year, lunar_month);
        }
        lunar_day += span_days;
    }
    else {
        lunar_month = 12;
        lunar_year -= 1;
        int month_days = get_lunar_month_days(lunar_year, lunar_month);
        while (abs(span_days) >= month_days) {
            span_days += month_days;
            lunar_month -= 1;
            if (lunar_month == leapMonthInfo.lunar_month) {
                if (abs(span_days) < month_days) {
                    is_leap = TRUE;
                    break;
                }
                span_days += leapMonthInfo.leap_month_days;
            }
            month_days = get_lunar_month_days(lunar_year, lunar_month);
        }
        lunar_day += (month_days + span_days);
    }

    lunarDate->is_leap = is_leap;
    lunarDate->lunar_ad_year = lunar_year;
    lunarDate->lunar_xy_year = lunar_year + 2697;
    lunarDate->lunar_month = lunar_month;
    lunarDate->lunar_day = lunar_day;
    return TRUE;
}


// 获取农历日期的中文表示
BOOL convert_lunar_to_chinese(const LunarDate *lunarDate, ChineseLunarDate* chineseLunarDate)
{
    char ad_year[5];
    char xy_year[5];
    sprintf(ad_year, "%d", lunarDate->lunar_ad_year);
    sprintf(xy_year, "%d", lunarDate->lunar_xy_year);
    int i;
    for (i = 0; i < strlen(ad_year); ++i) {
        strcpy(chineseLunarDate->c_lunar_ad_year + 3 * i, HAN_NUMBER[ad_year[i] - '0']);
    }
    strcpy(chineseLunarDate->c_lunar_ad_year + 3 * i, "年");
    for (i = 0; i < strlen(xy_year); ++i) {
        strcpy(chineseLunarDate->c_lunar_xy_year + 3 * i, HAN_NUMBER[xy_year[i] - '0']);
    }
    strcpy(chineseLunarDate->c_lunar_xy_year + 3 * i, "年");

    if (lunarDate->is_leap) {
        strcpy(chineseLunarDate->c_lunar_month, "闰");
        strcpy(chineseLunarDate->c_lunar_month + 3, HAN_YUEFEN[lunarDate->lunar_day - 1]);
    }
    else {
        strcpy(chineseLunarDate->c_lunar_month, HAN_YUEFEN[lunarDate->lunar_month - 1]);
    }

    strcpy(chineseLunarDate->c_lunar_day, HAN_RIQI[lunarDate->lunar_day - 1]);
}


// 获取干支的中文表示：天干地支序号从0开始
const char * _convert_to_ganzhi(const int tiangan, const int dizhi, char ganzhi[])
{
    sprintf(ganzhi, "%s%s", HAN_TIANGAN[tiangan], HAN_DIZHI[dizhi]);
    return ganzhi;
}


// 获取(干支年 月 日 时 地支时 刻数 星次:以中气分割 星座:以节气分割)
BOOL get_ganzhi_date(const int year, const int month, const int day, const int hour, const int min, GanZhiInfo *ganZhiInfo)
{
    // 截取year年节气日期
	const unsigned char * data = &G_LUNAR_JIEQI[12 * (year - 1900)]; // 12 * (year - 1900 + 1)

	// 计算干支对应公元纪年(ganzhi_year)和在干支纪月的第几个月份(ganzhi_month)
	// 元旦对应干支的上一年第11月
	int ganzhi_year = year - 1, ganzhi_month = 11, m = 1;
	for (; data < (unsigned char *)(&G_LUNAR_JIEQI + (12 * (year - 1900 + 1))); ++data) {
		// 节气日是干支月变化的日期
		const unsigned char jieqi_date = (15 - (*data >> 4));
		if (month == m) {
			if (day >= jieqi_date) {
				ganzhi_month += 1;
			}
			break;
		}
		else {
			m += 1;
			ganzhi_month += 1;
		}
	}
	// 以上计数时12月以后按13月计算，接下来换回正常计数
	if (ganzhi_month > 12) {
		ganzhi_year += 1;
		ganzhi_month -= 12;
	}
	const int year_tiangan = (ganzhi_year - 3) % 10 - 1;
	const int year_dizhi = (ganzhi_year - 3) % 12 - 1;


	// 计算月天干次序：冬月对应地支为“子”，天干与年份有循环对应关系
	int month_tiangan = (ganzhi_year % 5 - 2) * 2 - 1;
	month_tiangan = (month_tiangan < 0) ? (month_tiangan + 10) : month_tiangan;
	month_tiangan += (ganzhi_month - 1) - 1;
	month_tiangan %= 10;
	const int month_dizhi = (ganzhi_month + 1) % 12;

	// 使用高氏日柱公式计算日天干次序（R: 1~60，甲子~癸亥）
	const int _month[] = {0, 31, -1, 30, 0, 31, 1, 32, 3, 33, 4, 34}; // 月基数
	const int _year[] = {3, 47, 31, 15, 0, 44, 28, 12, 57, 41}; // 世纪常数（17 ~ 26世纪）
	const int S = year % 100 - 1;
	const int U = S % 4;
	const int M = _month[month - 1];
	int R = (S / 4) * 6 + 5 * ((S / 4) * 3 + U) + M + day + _year[((year - 1) / 100) + 1 - 17];
	if (is_solar_leap_year(year) && month > 2) {
		R += 1;
	}
	R = R == 60 ? R : R % 60;
	// 以上步骤得到日柱（日天干地支的次序数：1~60，下面将起点转化为0）
	R -= 1;
	const int day_tiangan = R % 10;
	const int day_dizhi = R % 12;

	// 时天干与月天干类似，与日天干有循环对应关系
	const int shi_tiangan = (((R % 10) % 5) * 2 + (((hour + 1) / 2))) % 10;
	const int shi_dizhi = (hour + 1) / 2;

	// 计算多少刻：正点过后加4刻
	const int keshu = (hour % 2 != 0) ? min / 15 + 1 : (min / 15) + 1 + 5;

	// 计算星次和星座
	const int xingcishu = (ganzhi_month == 12 ? 0 : ganzhi_month);
	const int this_month_zhongqi = 15 + (data[month - 1] & 0xf);
	const int xingzuoshu = (day < this_month_zhongqi ? month - 1 : month) % 12;

    char ganzhi[7];
    strcpy(ganZhiInfo->year_ganzhi, _convert_to_ganzhi(year_tiangan, year_dizhi, ganzhi));
    strcpy(ganZhiInfo->month_ganzhi, _convert_to_ganzhi(month_tiangan, month_dizhi, ganzhi));
    strcpy(ganZhiInfo->day_ganzhi, _convert_to_ganzhi(day_tiangan, day_dizhi, ganzhi));
    strcpy(ganZhiInfo->shi_ganzhi, _convert_to_ganzhi(shi_tiangan, shi_dizhi, ganzhi));
    sprintf(ganZhiInfo->shichen, "%s时", HAN_DIZHI[shi_dizhi]);
    sprintf(ganZhiInfo->keshu, "%s刻", HAN_NUMBER[keshu]);
    strcpy(ganZhiInfo->xingci, HAN_XINGCI[xingcishu]);
    strcpy(ganZhiInfo->xingzuo, HAN_XINGZUO[xingzuoshu]);

	return TRUE;
}

// 获取(当前节气名 持续天数 下一节气名 下一节气月 下一节气日 下一节气还有多少天)
BOOL get_jieqi_info(const int year, const int month, const int day, JieQiInfo *jieqiInfo)
{
    const int last_month = G_LUNAR_JIEQI[12 * (year - 1900) + month - 2];
	const int this_month = G_LUNAR_JIEQI[12 * (year - 1900) + month - 1];
	const int next_month = G_LUNAR_JIEQI[12 * (year - 1900) + month];
	const int l_jieqi = 15 - (last_month >> 4), l_zhongqi = 15 + (last_month & 0xf);
	const int jieqi = 15 - (this_month >> 4), zhongqi = 15 + (this_month & 0xf);
	const int n_jieqi = 15 - (next_month >> 4), n_zhongqi = 15 + (next_month & 0xf);
	// let this_jieqi = '', next_jieqi = '', next_jieqi_month = 0, next_jieqi_day = 0, l_num = 0, num = 0;

	const int l_month = month == 1 ? 12 : month - 1, l_year = month == 1 ? year - 1 : year;
	const int n_month = month == 12 ? 1 : month + 1, n_year = month == 12 ? year + 1 : year;
	const unsigned long long t_now = get_timestamp(year, month, day);
	const unsigned long long tl_zhongqi = get_timestamp(l_year, l_month, l_zhongqi);
	const unsigned long long t_jieqi = get_timestamp(year, month, jieqi);
	const unsigned long long t_zhongqi = get_timestamp(year, month, zhongqi);
	const unsigned long long tn_jieqi = get_timestamp(n_year, n_month, n_jieqi);
	
	// 上月中气(l_year, l_month, l_zhongqi) 本月节气(year, month, jieqi) 本月中气(year, month, zhingqi) 下月节气(n_year, n_month, n_jieqi)
	if (day < jieqi) {
		// 上月中气 ~ 本月节气前
        strcpy(jieqiInfo->this_jieqi, HAN_JIEQI[month == 1 ? 23 : (month - 2) * 2 + 1]);
        strcpy(jieqiInfo->next_jieqi, HAN_JIEQI[(month - 1) * 2]);

		jieqiInfo->next_jieqi_month = month;
		jieqiInfo->next_jieqi_day = jieqi;
		jieqiInfo->this_jieqi_days = (t_now - tl_zhongqi) / MILLISECOND_OF_YEAR;
		jieqiInfo->next_jieqi_days = (t_jieqi - t_now) / MILLISECOND_OF_YEAR;
	}
	else if (day == jieqi || day < zhongqi) {
        strcpy(jieqiInfo->this_jieqi, HAN_JIEQI[(month - 1) * 2]);
        strcpy(jieqiInfo->next_jieqi, HAN_JIEQI[(month - 1) * 2 + 1]);

		jieqiInfo->next_jieqi_month = month;
		jieqiInfo->next_jieqi_day = zhongqi;
		jieqiInfo->this_jieqi_days = (t_now - t_jieqi) / MILLISECOND_OF_YEAR;
		jieqiInfo->next_jieqi_days = (t_zhongqi - t_now) / MILLISECOND_OF_YEAR;
	}
	else {
        jieqiInfo->next_jieqi_month = month == 12 ? 1 : month + 1;
        jieqiInfo->next_jieqi_day = n_jieqi;
		jieqiInfo->this_jieqi_days = (t_now - t_zhongqi) / MILLISECOND_OF_YEAR;
		jieqiInfo->next_jieqi_days = (tn_jieqi - t_now) / MILLISECOND_OF_YEAR;
        strcpy(jieqiInfo->this_jieqi, HAN_JIEQI[(month - 1) * 2 + 1]);
        strcpy(jieqiInfo->next_jieqi, HAN_JIEQI[(jieqiInfo->next_jieqi_month - 1) * 2]);
	}
	return TRUE;
}

BOOL display_gregorian_date()
{
    // printf("[公历]: %d/%d/%d %s %d:%d:%d\n");
    return FALSE;
}

BOOL display_lunar_date(const ChineseLunarDate *chineseLunarDate)
{
    printf("[农历]: 公元%s(开元%s) %s %s\n", chineseLunarDate->c_lunar_ad_year, chineseLunarDate->c_lunar_xy_year, chineseLunarDate->c_lunar_month, chineseLunarDate->c_lunar_day);
    return TRUE;
}


BOOL display_ganzhi_date(const GanZhiInfo *ganZhiInfo) 
{
    printf("[干支历]: %s %s %s %s\n[时辰]: %s %s\n[星次]: %s\n[星座]: %s\n", ganZhiInfo->year_ganzhi, ganZhiInfo->month_ganzhi, ganZhiInfo->day_ganzhi, ganZhiInfo->shi_ganzhi, ganZhiInfo->shichen, ganZhiInfo->keshu, ganZhiInfo->xingci, ganZhiInfo->xingzuo);
    return TRUE;
}


BOOL display_jieqi_info(const JieQiInfo *jieQiInfo)
{
    printf("[节气]: 距上一个节气[%s]已经过了%d天, 距离下一个节气[%s(%d月%d日)]还有%d天\n", jieQiInfo->this_jieqi, jieQiInfo->this_jieqi_days, jieQiInfo->next_jieqi, jieQiInfo->next_jieqi_month, jieQiInfo->next_jieqi_day, jieQiInfo->next_jieqi_days);
    return TRUE;
}
